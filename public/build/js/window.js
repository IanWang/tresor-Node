/*! tresor - v0.0.3 - 2013-10-13 */$(function(){function a(){a=Function(""),f(d,h)}var b=$(".masonry"),c=!1,d={},e=!1,f=function(a){return e=!0,c?void 0:$.ajax({url:"/allProduct",type:"GET",contentType:"application/json",data:a,dataType:"json",success:function(b){a.page=b.meta.next,a.type="",h(b),null==a.page&&(c=!0,$(".end").fadeIn("slow"))}})},g=doT.template('<div class="item"><a href="#inline_content" data-id="{{=it.id}}" class="ajax-href"><img src="{{=it.image[0].w236.relative_path}}" title="{{=it.title}}" style="height: {{=it.image[0].w236.height}}px" class="imgFade"></a><div class="info"></a><div class="title"><a href="#inline_content" data-id="{{=it.id}}" class="ajax-href">{{=it.title}}</a></div><div class="seller"><a href="#">{{=it.seller.facebook_name}}</a></div><div class="price">${{=it.sold_price}}</div></div></div>'),h=function(a){a.objects.forEach(function(a){try{b.append(g(a))}catch(c){console.log("no img")}}),b.masonry("reload"),e=!1,$(".ajax-href").click(function(){$("#inline_content").empty();var a=$(this).attr("data-id"),b="/product/"+a,c=$("#inline_content"),d=b;history.pushState(b,"",b),$.ajax({url:d,type:"GET",data:{light:!0},dataType:"html",success:function(a){c.empty(),c.append(a)},error:function(){}})}),$(".ajax-href").colorbox({inline:!0,fixed:!0,width:"1050",height:"98%",onCleanup:function(){history.pushState("/","","/")}})};$(window).load(function(){b.masonry({itemSelector:".item",columnWidth:250,isFitWidth:!0}),$(window).scroll(function(){$(window).scrollTop()>=$(document).height()-$(window).height()-300&&(e||f(d,h)),$(window).width()>=1650&&(e||a())}),$(window).trigger("scroll")}),$(window).resize(function(){b.masonry("reload")}),$("#filter .dropdown-menu li").click(function(){$(".masonry").empty();var a=$(this).find("a"),b=a.attr("data-type");d.type=b,c=!1,f(d,h)})});